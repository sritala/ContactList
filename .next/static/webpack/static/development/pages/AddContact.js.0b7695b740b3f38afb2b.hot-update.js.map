{"version":3,"file":"static/webpack/static/development/pages/AddContact.js.0b7695b740b3f38afb2b.hot-update.js","sources":["webpack:///./src/components/ui/Form.tsx"],"sourcesContent":["import React, { useState, useEffect } from 'react';\nimport { Typography, Grid, makeStyles, Box } from '@material-ui/core';\nimport Dialog from './Dialog';\nimport personService from '../services/persons';\nimport PersonForm from './PersonForm';\nimport Persons from './Persons';\nimport Notification from './Notification';\n\nconst useStyles = makeStyles((theme) => ({\n   dialog:{\n    paddingTop:'1rem',   \n  },\n   \n}));\n\nexport default function () {\n\n  const classes = useStyles();\n\n  const [persons, setPersons] = useState([]);\n  const [newName, setNewName] = useState('');\n  const [newNumber, setNewNumber] = useState('');\n  const [searchName, setSearchName] = useState('');\n  const [showAll, setShowAll] = useState(true);\n  const [notificationMessage, setNotificationMessage] = useState(null);\n  const [errorMessage, setErrorMessage] = useState(null);\n\n  useEffect(() => {\n    personService\n      .getAll()\n      .then(initialPersons => {\n        setPersons(initialPersons);\n      });\n  }, []);\n\n  const personIsAdded = (name, data) => {\n    let isAdded = data.find(el => el.name === name);\n    if (isAdded === undefined) {\n      return false;\n    }\n    return true;\n  } \n\n  const addContact = event => {\n    event.preventDefault();\n    // Check if the contact already exists\n    const toUpdate = persons.filter(p => {\n      return p.name.includes(newName);\n    });\n    if (toUpdate.length === 1) {\n      const confirm = window.confirm(`${newName} is already added to Contact List, replace the old number with a new one?`);\n      if (confirm) {\n        personService\n          .update(toUpdate[0].id, {\n            ...toUpdate[0],\n            number: newNumber\n          })\n          .then(updatedPerson => {\n            let updatedState = persons.filter(p => p.id !== updatedPerson.id);\n            updatedState = [...updatedState, updatedPerson];\n            setPersons(updatedState);\n            setNewName('');\n            setNewNumber('');\n            setNotificationMessage(`Added ${updatedPerson.name}`);\n            setTimeout(() => {\n              setNotificationMessage(null)\n            }, 2000);\n          })\n          .catch(error => {\n            setErrorMessage(`Information of ${newName} has already been removed from server`);\n            setTimeout(() => {\n              setErrorMessage(null)\n            }, 5000);\n          })\n      }\n    } else {\n      // if not, save the person\n      const personObject = {\n        name: newName,\n        number: newNumber,\n        id: persons.length + 1\n      }\n\n      personService\n        .create(personObject)\n        .then(returnedNote => {\n          if (personIsAdded(newName, persons)) {\n            alert(`${newName} is already added to Contact List`);\n          }\n          else {\n            setPersons([...persons, { name: newName, number: newNumber }]);\n          }\n          setNotificationMessage(`Added ${newName}`);\n          setTimeout(() => {\n            setNotificationMessage(null)\n          }, 2000);\n          setNewName('');\n          setNewNumber('');\n        })\n        .catch(error => {\n          setErrorMessage(`Information of ${newName} has already been removed from server`);\n          setTimeout(() => {\n            setErrorMessage(null)\n          }, 5000);\n        })\n    }\n  }\n  \n  const handleNameChange = event => {\n    setNewName(event.target.value);\n  }\n\n  const handleNumberChange = event => {\n    setNewNumber(event.target.value);\n  }\n\n  const cancel = () => {\n    setNewName('');\n    setNewNumber('');\n  };\n\n  const deletePerson = id => {\n    personService\n      .remove(id)\n      .then(() => {\n        const updatedPersons = persons.filter(p => p.id !== id);\n        setPersons(updatedPersons);\n      })\n  }\n\n  const handleSearchName = event => {\n    setSearchName(event.target.value);\n    setShowAll(false);\n  }\n\n  const contactsToShow = showAll\n  ? persons\n  : persons.filter(person => {\n      let toFilter = person.name.toLocaleLowerCase();\n      let toSearch = searchName.toLowerCase()\n      return toFilter.includes(toSearch);\n    });\n\n      return (\n        <div>\n          <Grid container={true}>\n            <Grid item={true}>\n              <PersonForm\n                handleOnSubmit={addContact}\n                newName={newName}\n                handleOnNameChange={handleNameChange}\n                newNumber={newNumber}\n                handleOnNumberChange={handleNumberChange}\n                cancel = {cancel}\n              />\n            </Grid>\n          </Grid>\n          <Box className={classes.dialog}>\n             <Dialog \n             contactsToShow={contactsToShow}\n             handleSearchName = {handleSearchName}\n             deletePerson = {deletePerson}\n             persons = {persons}\n             />\n          </Box>\n          <Notification type={\"error\"} message={errorMessage} />\n        </div>\n      );\n    }\n\n"],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAAA;AACA;AACA;AACA;AACA;AAEA;AAEA;AACA;AACA;AADA;AADA;AAOA;AAEA;AAEA;AAAA;AAAA;AAAA;AACA;AAAA;AAAA;AAAA;AACA;AAAA;AAAA;AAAA;AACA;AAAA;AAAA;AAAA;AACA;AAAA;AAAA;AAAA;AACA;AAAA;AAAA;AAAA;AACA;AAAA;AAAA;AAAA;AAEA;AACA;AAGA;AACA;AACA;AACA;AACA;AACA;AACA;AAAA;AACA;AACA;AACA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAAA;AACA;AACA;AAAA;AACA;AAGA;AAHA;AAMA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAHA;AAMA;AAGA;AACA;AACA;AAEA;AAAA;AAAA;AAAA;AACA;AACA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAGA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAGA;AACA;AACA;AACA;AAEA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAEA;AACA;AACA;AACA;AACA;AACA;AANA;AAAA;AAAA;AAAA;AAAA;AAAA;AAUA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAEA;AACA;AACA;AACA;AAJA;AAAA;AAAA;AAAA;AAAA;AAAA;AAOA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAGA;;;;A","sourceRoot":""}